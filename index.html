<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuiz Pendidikan Islam Tingkatan 2</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .question-card {
            transition: all 0.3s ease;
        }
        
        .option-btn {
            transition: all 0.2s ease;
        }
        
        .option-btn:hover {
            transform: translateX(8px);
        }
        
        .correct {
            background-color: #10b981 !important;
            border-color: #059669 !important;
        }
        
        .incorrect {
            background-color: #ef4444 !important;
            border-color: #dc2626 !important;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .celebration {
            animation: celebrate 0.6s ease-out;
        }
        
        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="min-h-full flex items-center justify-center p-4">
  <div id="app" class="w-full max-w-3xl"></div>
  <script>
        const defaultConfig = {
            background_color: "#f0f9ff",
            surface_color: "#ffffff",
            text_color: "#1e293b",
            primary_action_color: "#0ea5e9",
            secondary_action_color: "#64748b",
            quiz_title: "Kuiz Pendidikan Islam Pelajaran 23",
            quiz_subtitle: "",
            font_family: "Inter",
            font_size: 16
        };

        const questions = [
            {
                id: 1,
                question: "Siapakah nama sebenar Sayidatina Khadijah r.a.?",
                options: [
                    "Khadijah binti Huzaifah",
                    "Khadijah binti Khuzaimah",
                    "Khadijah binti Khuwailid",
                    "Khadijah binti Umar"
                ],
                correct: 2
            },
            {
                id: 2,
                question: "Sayidatina Aisyah r.a. berketurunan _______________.",
                options: [
                    "Bani Tsaqif",
                    "Bani Hashim",
                    "Bani Abd Manaf",
                    "Bangsawan Quraisy (Suku Bani Tamim)"
                ],
                correct: 3
            },
            {
                id: 3,
                question: "Berapakah umur wafat Sayidatina Fatimah r.a.?",
                options: [
                    "20 tahun",
                    "25 tahun",
                    "28 tahun",
                    "30 tahun"
                ],
                correct: 2
            },
            {
                id: 4,
                question: "Berikut adalah iktibar daripada perjuangan Sayidatina Aisyah r.a. kecuali",
                options: [
                    "Bersedekah dan suka membantu",
                    "Belajar bersungguh-sungguh hingga menjadi pakar",
                    "Sentiasa bersabar, berdoa serta berserah diri kepada Allah SWT",
                    "Berusaha menjadi anak yang soleh dan tegas menegakkan kebenaran"
                ],
                correct: 3
            },
            {
                id: 5,
                question: "Gelaran 'Al-Humaira' bagi Sayidatina Aisyah r.a. merujuk kepada ________________.",
                options: [
                    "Berkulit cerah",
                    "Putih kekuningan",
                    "Putih kemerah-merahan",
                    "Kemerah-merahan gelap"
                ],
                correct: 2
            },
            {
                id: 6,
                question: "Antara berikut, yang manakah merupakan sifat utama Sayidatina Khadijah r.a.?",
                options: [
                    "Bijak bertindak",
                    "Kurang bercakap",
                    "Suka bersendirian",
                    "Pemarah dan tegas"
                ],
                correct: 0
            },
            {
                id: 7,
                question: "Sumbangan Sayidatina Fatimah r.a. dalam dakwah ialah _______________________.",
                options: [
                    "Berjaya mendidik anak-anaknya menjadi Muslim yang soleh",
                    "Membelanjakan semua hartanya untuk Islam",
                    "Mengajar wanita Quraisy berniaga",
                    "Menjadi penasihat kabilah Arab"
                ],
                correct: 0
            },
            {
                id: 8,
                question: "Siapakah suami kepada Sayidatina Sumaiyah r.a.?",
                options: [
                    "Uthman bin Affan",
                    "Zaid bin Harithah",
                    "Ali bin Abi Talib",
                    "Yasir bin Amir"
                ],
                correct: 3
            },
            {
                id: 9,
                question: "Tokoh wanita Islam yang sanggup menggadaikan nyawa demi Islam ialah ____________________________.",
                options: [
                    "Sayidatina Aisyah r.a.",
                    "Sayidatina Fatimah r.a.",
                    "Sayidatina Khadijah r.a.",
                    "Sayidatina Sumaiyah r.a."
                ],
                correct: 3
            },
            {
                id: 10,
                question: "Apakah kedudukan Sayidatina Fatimah r.a. dalam keluarga?",
                options: [
                    "Puteri bongsu Rasulullah SAW dan Sayidatina Khadijah r.a.",
                    "Puteri sulung Rasulullah SAW dan Sayidatina Khadijah r.a.",
                    "Puteri kedua Rasulullah SAW dan Sayidatina Khadijah r.a.",
                    "Puteri keempat Rasulullah SAW dan Sayidatina Khadijah r.a."
                ],
                correct: 0
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answered = false;
        let quizCompleted = false;
        let isSubmitting = false;

        const dataHandler = {
            onDataChanged(data) {
                // No UI updates needed for write-only quiz
            }
        };

        async function onConfigChange(config) {
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const baseFontStack = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';

            document.body.style.backgroundColor = config.background_color || defaultConfig.background_color;
            document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

            const appElement = document.getElementById('app');
            if (appElement) {
                appElement.style.color = config.text_color || defaultConfig.text_color;
            }

            const titleElement = document.getElementById('quiz-title');
            if (titleElement) {
                titleElement.textContent = config.quiz_title || defaultConfig.quiz_title;
                titleElement.style.fontSize = `${baseSize * 2}px`;
                titleElement.style.color = config.text_color || defaultConfig.text_color;
            }

            const subtitleElement = document.getElementById('quiz-subtitle');
            if (subtitleElement) {
                subtitleElement.textContent = config.quiz_subtitle || defaultConfig.quiz_subtitle;
                subtitleElement.style.fontSize = `${baseSize * 1.125}px`;
                subtitleElement.style.color = config.text_color || defaultConfig.text_color;
            }

            const cards = document.querySelectorAll('.question-card');
            cards.forEach(card => {
                card.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
            });

            const questionText = document.getElementById('question-text');
            if (questionText) {
                questionText.style.fontSize = `${baseSize * 1.25}px`;
                questionText.style.color = config.text_color || defaultConfig.text_color;
            }

            const progressText = document.getElementById('progress-text');
            if (progressText) {
                progressText.style.fontSize = `${baseSize * 0.875}px`;
                progressText.style.color = config.text_color || defaultConfig.text_color;
            }

            const options = document.querySelectorAll('.option-btn');
            options.forEach(option => {
                if (!option.classList.contains('correct') && !option.classList.contains('incorrect')) {
                    option.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
                    option.style.borderColor = config.secondary_action_color || defaultConfig.secondary_action_color;
                    option.style.color = config.text_color || defaultConfig.text_color;
                }
                option.style.fontSize = `${baseSize}px`;
            });

            const primaryButtons = document.querySelectorAll('.primary-btn');
            primaryButtons.forEach(btn => {
                btn.style.backgroundColor = config.primary_action_color || defaultConfig.primary_action_color;
                btn.style.fontSize = `${baseSize}px`;
            });

            const secondaryButtons = document.querySelectorAll('.secondary-btn');
            secondaryButtons.forEach(btn => {
                btn.style.backgroundColor = config.secondary_action_color || defaultConfig.secondary_action_color;
                btn.style.fontSize = `${baseSize}px`;
            });

            const labels = document.querySelectorAll('.form-label');
            labels.forEach(label => {
                label.style.fontSize = `${baseSize * 0.875}px`;
                label.style.color = config.text_color || defaultConfig.text_color;
            });

            const inputs = document.querySelectorAll('input[type="text"]');
            inputs.forEach(input => {
                input.style.fontSize = `${baseSize}px`;
                input.style.borderColor = config.secondary_action_color || defaultConfig.secondary_action_color;
            });

            const resultTitle = document.getElementById('result-title');
            if (resultTitle) {
                resultTitle.style.fontSize = `${baseSize * 2}px`;
                resultTitle.style.color = config.text_color || defaultConfig.text_color;
            }

            const scoreDisplay = document.getElementById('score-display');
            if (scoreDisplay) {
                scoreDisplay.style.fontSize = `${baseSize * 3}px`;
                scoreDisplay.style.color = config.primary_action_color || defaultConfig.primary_action_color;
            }

            const resultText = document.getElementById('result-text');
            if (resultText) {
                resultText.style.fontSize = `${baseSize * 1.125}px`;
                resultText.style.color = config.text_color || defaultConfig.text_color;
            }
        }



        function renderQuestion() {
            const config = window.elementSdk?.config || defaultConfig;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const baseFontStack = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            
            answered = false;
            const question = questions[currentQuestion];
            
            document.getElementById('app').innerHTML = `
                <div class="text-center mb-6 fade-in">
                    <h1 id="quiz-title" class="font-bold mb-1" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 1.5}px; color: ${config.text_color || defaultConfig.text_color}">${config.quiz_title || defaultConfig.quiz_title}</h1>
                    <p id="quiz-subtitle" class="text-sm" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 0.875}px; color: ${config.text_color || defaultConfig.text_color}">${config.quiz_subtitle || defaultConfig.quiz_subtitle}</p>
                </div>
                <div class="question-card bg-white rounded-2xl shadow-xl p-8 fade-in" style="background-color: ${config.surface_color || defaultConfig.surface_color}">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <span id="progress-text" class="font-medium" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 0.875}px; color: ${config.text_color || defaultConfig.text_color}">Soalan ${currentQuestion + 1} / ${questions.length}</span>
                            <span class="font-bold" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 0.875}px; color: ${config.text_color || defaultConfig.text_color}">Markah: ${score}</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="h-2.5 rounded-full transition-all duration-300" style="width: ${((currentQuestion + 1) / questions.length) * 100}%; background-color: ${config.primary_action_color || defaultConfig.primary_action_color}"></div>
                        </div>
                    </div>
                    
                    <h2 id="question-text" class="font-bold mb-8" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 1.25}px; color: ${config.text_color || defaultConfig.text_color}">${question.question}</h2>
                    
                    <div class="space-y-3" id="options-container">
                        ${question.options.map((option, index) => `
                            <button 
                                onclick="selectAnswer(${index})"
                                class="option-btn w-full text-left px-6 py-4 border-2 rounded-lg font-medium hover:shadow-md"
                                style="background-color: ${config.surface_color || defaultConfig.surface_color}; border-color: ${config.secondary_action_color || defaultConfig.secondary_action_color}; color: ${config.text_color || defaultConfig.text_color}; font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize}px"
                            >
                                ${String.fromCharCode(65 + index)}. ${option}
                            </button>
                        `).join('')}
                    </div>
                    
                    <div id="feedback" class="mt-6 min-h-[60px]"></div>
                    
                    <button 
                        id="next-btn"
                        onclick="nextQuestion()"
                        class="primary-btn w-full text-white font-semibold py-4 rounded-lg mt-6 opacity-50 cursor-not-allowed"
                        style="background-color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize}px"
                        disabled
                    >
                        ${currentQuestion === questions.length - 1 ? 'Selesai' : 'Soalan Seterusnya'}
                    </button>
                </div>
            `;
        }

        function selectAnswer(selectedIndex) {
            if (answered) return;
            
            answered = true;
            const config = window.elementSdk?.config || defaultConfig;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const baseFontStack = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            const question = questions[currentQuestion];
            const buttons = document.querySelectorAll('.option-btn');
            
            buttons.forEach((btn, index) => {
                btn.disabled = true;
                btn.style.cursor = 'not-allowed';
                
                if (index === question.correct) {
                    btn.classList.add('correct');
                    btn.style.backgroundColor = '#10b981';
                    btn.style.borderColor = '#059669';
                    btn.style.color = '#ffffff';
                }
                
                if (index === selectedIndex && selectedIndex !== question.correct) {
                    btn.classList.add('incorrect');
                    btn.style.backgroundColor = '#ef4444';
                    btn.style.borderColor = '#dc2626';
                    btn.style.color = '#ffffff';
                }
            });
            
            const isCorrect = selectedIndex === question.correct;
            if (isCorrect) {
                score++;
            }
            
            const feedback = document.getElementById('feedback');
            feedback.innerHTML = `
                <div class="p-4 rounded-lg ${isCorrect ? 'bg-green-100 border-2 border-green-400' : 'bg-red-100 border-2 border-red-400'}">
                    <p class="font-semibold ${isCorrect ? 'text-green-700' : 'text-red-700'}" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize}px">
                        ${isCorrect ? 'âœ“ Betul!' : 'âœ— Tidak betul'}
                    </p>
                    ${!isCorrect ? `<p class="mt-2 text-green-700" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 0.875}px">Jawapan yang betul: ${String.fromCharCode(65 + question.correct)}. ${question.options[question.correct]}</p>` : ''}
                </div>
            `;
            
            const nextBtn = document.getElementById('next-btn');
            nextBtn.disabled = false;
            nextBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            nextBtn.classList.add('hover:opacity-90');
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
            } else {
                showResults();
            }
        }

        async function showResults() {
            if (isSubmitting) return;
            
            isSubmitting = true;
            quizCompleted = true;
            const percentage = Math.round((score / questions.length) * 100);
            const config = window.elementSdk?.config || defaultConfig;
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const baseFontStack = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
            
            let emoji = 'ðŸŒŸ';
            let message = 'Cemerlang!';
            if (percentage < 50) {
                emoji = 'ðŸ’ª';
                message = 'Teruskan usaha!';
            } else if (percentage < 75) {
                emoji = 'ðŸ‘';
                message = 'Bagus!';
            }
            
            document.getElementById('app').innerHTML = `
                <div class="question-card bg-white rounded-2xl shadow-xl p-8 fade-in celebration" style="background-color: ${config.surface_color || defaultConfig.surface_color}">
                    <div class="text-center">
                        <div class="text-7xl mb-4">${emoji}</div>
                        <h2 id="result-title" class="font-bold mb-4" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 2}px; color: ${config.text_color || defaultConfig.text_color}">${message}</h2>
                        <p class="mb-2" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 1.125}px; color: ${config.text_color || defaultConfig.text_color}">Tahniah!</p>
                        
                        <div class="my-8 p-6 rounded-xl" style="background-color: ${config.background_color || defaultConfig.background_color}">
                            <p id="score-display" class="font-bold mb-2" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 3}px; color: ${config.primary_action_color || defaultConfig.primary_action_color}">${score} / ${questions.length}</p>
                            <p id="result-text" class="font-medium" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 1.125}px; color: ${config.text_color || defaultConfig.text_color}">Peratusan: ${percentage}%</p>
                        </div>
                        
                        <div id="save-message" class="mb-4 p-3 bg-blue-100 border-2 border-blue-400 text-blue-700 rounded-lg" style="font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize * 0.875}px">
                            Menyimpan keputusan...
                        </div>
                        
                        <button 
                            onclick="restartQuiz()"
                            class="primary-btn w-full text-white font-semibold py-4 rounded-lg hover:opacity-90 transition-opacity"
                            style="background-color: ${config.primary_action_color || defaultConfig.primary_action_color}; font-family: ${customFont}, ${baseFontStack}; font-size: ${baseSize}px"
                        >
                            Cuba Lagi
                        </button>
                    </div>
                </div>
            `;

            const result = await window.dataSdk.create({
                score: score,
                total_questions: questions.length,
                completed_at: new Date().toISOString()
            });

            const saveMessage = document.getElementById('save-message');
            if (result.isOk) {
                saveMessage.className = 'mb-4 p-3 bg-green-100 border-2 border-green-400 text-green-700 rounded-lg';
                saveMessage.textContent = 'âœ“ Keputusan anda telah disimpan!';
                saveMessage.style.fontFamily = `${customFont}, ${baseFontStack}`;
                saveMessage.style.fontSize = `${baseSize * 0.875}px`;
            } else {
                saveMessage.className = 'mb-4 p-3 bg-red-100 border-2 border-red-400 text-red-700 rounded-lg';
                saveMessage.textContent = 'âœ— Gagal menyimpan keputusan. Sila cuba lagi.';
                saveMessage.style.fontFamily = `${customFont}, ${baseFontStack}`;
                saveMessage.style.fontSize = `${baseSize * 0.875}px`;
            }
            
            isSubmitting = false;
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            answered = false;
            quizCompleted = false;
            renderQuestion();
        }

        async function init() {
            const initResult = await window.dataSdk.init(dataHandler);
            if (!initResult.isOk) {
                console.error("Failed to initialize data SDK");
            }

            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities: (config) => ({
                        recolorables: [
                            {
                                get: () => config.background_color || defaultConfig.background_color,
                                set: (value) => {
                                    config.background_color = value;
                                    window.elementSdk.setConfig({ background_color: value });
                                }
                            },
                            {
                                get: () => config.surface_color || defaultConfig.surface_color,
                                set: (value) => {
                                    config.surface_color = value;
                                    window.elementSdk.setConfig({ surface_color: value });
                                }
                            },
                            {
                                get: () => config.text_color || defaultConfig.text_color,
                                set: (value) => {
                                    config.text_color = value;
                                    window.elementSdk.setConfig({ text_color: value });
                                }
                            },
                            {
                                get: () => config.primary_action_color || defaultConfig.primary_action_color,
                                set: (value) => {
                                    config.primary_action_color = value;
                                    window.elementSdk.setConfig({ primary_action_color: value });
                                }
                            },
                            {
                                get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                                set: (value) => {
                                    config.secondary_action_color = value;
                                    window.elementSdk.setConfig({ secondary_action_color: value });
                                }
                            }
                        ],
                        borderables: [],
                        fontEditable: {
                            get: () => config.font_family || defaultConfig.font_family,
                            set: (value) => {
                                config.font_family = value;
                                window.elementSdk.setConfig({ font_family: value });
                            }
                        },
                        fontSizeable: {
                            get: () => config.font_size || defaultConfig.font_size,
                            set: (value) => {
                                config.font_size = value;
                                window.elementSdk.setConfig({ font_size: value });
                            }
                        }
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ["quiz_title", config.quiz_title || defaultConfig.quiz_title],
                        ["quiz_subtitle", config.quiz_subtitle || defaultConfig.quiz_subtitle]
                    ])
                });
            }

            renderQuestion();
            await onConfigChange(window.elementSdk?.config || defaultConfig);
        }

        init();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a1c88b3d0be16ee',t:'MTc2MzY4OTgwMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
