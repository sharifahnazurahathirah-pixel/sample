<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Praktis Sistem Nombor Perenambelasan</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        .hex-digit {
            transition: all 0.3s ease;
            display: inline-block;
            min-width: 1.5rem;
            text-align: center;
        }
        .hex-digit:hover {
            transform: scale(1.1);
        }
        
        /* Enhanced button styles for better mobile interaction */
        button {
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        /* Ensure buttons are easily tappable on mobile */
        @media (max-width: 640px) {
            button {
                min-height: 48px;
                font-size: 16px;
            }
        }
        .calculation-step {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .success-animation {
            animation: bounce 0.6s ease-in-out;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        #hex-display {
            min-height: 4rem;
            display: flex !important;
            align-items: center;
            justify-content: center;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="min-h-full bg-gradient-to-br from-blue-50 to-indigo-100">
  <main class="container mx-auto px-2 sm:px-4 py-4 sm:py-8 max-w-4xl"><!-- Header -->
   <header class="text-center mb-6 sm:mb-8">
    <h1 id="app-title" class="text-2xl sm:text-3xl lg:text-4xl font-bold text-indigo-800 mb-4 px-2">Praktis Sistem Nombor Perenambelasan</h1><!-- Introduction -->
    <div class="bg-gradient-to-r from-indigo-50 to-blue-50 rounded-xl p-4 sm:p-6 mb-4 sm:mb-6 border border-indigo-200">
     <h2 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-3">üéØ Pengenalan</h2>
     <p class="text-sm sm:text-base text-gray-700 mb-3 leading-relaxed">Selamat datang ke praktis interaktif Sistem Nombor Perenambelasan! Dalam praktis ini, anda akan belajar cara menukar nombor perenambelasan kepada nombor perpuluhan.</p>
     <div class="bg-white rounded-lg p-3 sm:p-4 border-l-4 border-indigo-400">
      <p class="text-xs sm:text-sm text-gray-600 leading-relaxed"><strong>Objektif:</strong> Menguasai teknik penukaran nombor perenambelasan kepada perpuluhan menggunakan kaedah nilai tempat.</p>
     </div>
    </div>
    <p id="instruction-text" class="text-base sm:text-lg text-gray-700 bg-white rounded-lg p-3 sm:p-4 shadow-md">Tukar nombor perenambelasan kepada nombor perpuluhan</p>
   </header><!-- Reference Card -->
   <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-6 sm:mb-8">
    <h2 class="text-lg sm:text-xl font-semibold text-indigo-700 mb-4">üìö Rujukan Sistem Perenambelasan</h2>
    <div class="grid grid-cols-4 sm:grid-cols-8 gap-1 sm:gap-2 mb-3 sm:mb-4">
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       0
      </div>
      <div class="text-xs text-gray-600">
       0
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       1
      </div>
      <div class="text-xs text-gray-600">
       1
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       2
      </div>
      <div class="text-xs text-gray-600">
       2
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       3
      </div>
      <div class="text-xs text-gray-600">
       3
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       4
      </div>
      <div class="text-xs text-gray-600">
       4
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       5
      </div>
      <div class="text-xs text-gray-600">
       5
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       6
      </div>
      <div class="text-xs text-gray-600">
       6
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-indigo-50 rounded">
      <div class="font-bold text-indigo-800 text-sm sm:text-base">
       7
      </div>
      <div class="text-xs text-gray-600">
       7
      </div>
     </div>
    </div>
    <div class="grid grid-cols-4 sm:grid-cols-8 gap-1 sm:gap-2">
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       8
      </div>
      <div class="text-xs text-gray-600">
       8
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       9
      </div>
      <div class="text-xs text-gray-600">
       9
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       A
      </div>
      <div class="text-xs text-gray-600">
       10
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       B
      </div>
      <div class="text-xs text-gray-600">
       11
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       C
      </div>
      <div class="text-xs text-gray-600">
       12
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       D
      </div>
      <div class="text-xs text-gray-600">
       13
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       E
      </div>
      <div class="text-xs text-gray-600">
       14
      </div>
     </div>
     <div class="text-center p-1 sm:p-2 bg-green-50 rounded">
      <div class="font-bold text-green-800 text-sm sm:text-base">
       F
      </div>
      <div class="text-xs text-gray-600">
       15
      </div>
     </div>
    </div>
   </div><!-- Question Section -->
   <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6 lg:p-8 mb-4 sm:mb-6">
    <div class="text-center mb-4 sm:mb-6">
     <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-3 sm:mb-4">Soalan <span id="question-counter">1</span></h2>
     <p class="text-sm sm:text-base lg:text-lg text-gray-600 mb-4 px-2">Tukarkan nombor perenambelasan ini kepada perpuluhan:</p><!-- Hex Number Display -->
     <div class="flex justify-center items-center mb-4 sm:mb-6">
      <div id="hex-display" class="text-2xl sm:text-3xl lg:text-4xl font-bold text-indigo-600 bg-indigo-50 px-4 sm:px-6 py-3 sm:py-4 rounded-lg border-2 border-indigo-200">
       A
      </div><span class="text-lg sm:text-xl lg:text-2xl text-gray-500 ml-2">‚ÇÅ‚ÇÜ</span>
     </div><!-- Step-by-step calculation -->
     <div id="calculation-steps" class="bg-gray-50 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6 hidden">
      <h3 class="font-semibold text-gray-700 mb-3 text-sm sm:text-base">Langkah Pengiraan:</h3>
      <div id="steps-content"></div>
     </div><!-- Answer Input -->
     <div class="flex flex-col sm:flex-row justify-center items-center gap-2 sm:gap-4 mb-4 px-4"><input type="number" id="answer-input" placeholder="Jawapan anda" class="text-lg sm:text-xl px-3 sm:px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none w-full sm:w-48 text-center"> <span class="text-lg sm:text-xl text-gray-500">‚ÇÅ‚ÇÄ</span>
     </div><!-- Buttons -->
     <div class="flex flex-col sm:flex-row justify-center gap-3 mb-4 px-4 max-w-md mx-auto"><button id="check-btn" class="bg-indigo-600 hover:bg-indigo-700 active:bg-indigo-800 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 text-base w-full sm:w-auto min-h-[48px] touch-manipulation"> Semak Jawapan </button> <button id="show-steps-btn" class="bg-gray-500 hover:bg-gray-600 active:bg-gray-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 text-base w-full sm:w-auto min-h-[48px] touch-manipulation"> Tunjuk Langkah </button> <button id="next-btn" class="bg-green-600 hover:bg-green-700 active:bg-green-800 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 text-base w-full sm:w-auto min-h-[48px] touch-manipulation hidden"> Soalan Seterusnya </button>
     </div><!-- Feedback -->
     <div id="feedback" class="text-base sm:text-lg font-semibold hidden px-2"></div>
    </div>
   </div><!-- Progress Section -->
   <div class="bg-white rounded-xl shadow-lg p-4 sm:p-6">
    <h3 class="text-lg sm:text-xl font-semibold text-gray-800 mb-4">üìä Kemajuan Anda</h3>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4">
     <div class="text-center p-3 sm:p-4 bg-blue-50 rounded-lg">
      <div class="text-xl sm:text-2xl font-bold text-blue-600" id="total-questions">
       0
      </div>
      <div class="text-xs sm:text-sm text-gray-600">
       Jumlah Soalan
      </div>
     </div>
     <div class="text-center p-3 sm:p-4 bg-green-50 rounded-lg">
      <div class="text-xl sm:text-2xl font-bold text-green-600" id="correct-answers">
       0
      </div>
      <div class="text-xs sm:text-sm text-gray-600">
       Jawapan Betul
      </div>
     </div>
     <div class="text-center p-3 sm:p-4 bg-purple-50 rounded-lg">
      <div class="text-xl sm:text-2xl font-bold text-purple-600" id="accuracy">
       0%
      </div>
      <div class="text-xs sm:text-sm text-gray-600">
       Ketepatan
      </div>
     </div>
    </div>
   </div>
  </main>
  <script>
        // Configuration object
        const defaultConfig = {
            app_title: "Praktis Sistem Nombor Perenambelasan",
            instruction_text: "Tukar nombor perenambelasan kepada nombor perpuluhan",
            success_message: "Tahniah! Jawapan anda betul! üéâ"
        };

        // Application state
        let currentQuestion = null;
        let questionCount = 0;
        let correctCount = 0;
        let currentRecordCount = 0;

        // Hex numbers for practice (various difficulty levels)
        const hexNumbers = [
            'A', 'B', 'C', 'D', 'E', 'F',
            '1A', '2B', '3C', '4D', '5E', '6F',
            '10', '20', '30', '40', '50', '60',
            'AB', 'CD', 'EF', 'BC', 'DE', 'FA',
            '100', '200', '1AB', '2CD', '3EF'
        ];

        // Data SDK handler
        const dataHandler = {
            onDataChanged(data) {
                currentRecordCount = data.length;
                updateProgress();
            }
        };

        // Initialize SDKs
        async function initializeApp() {
            try {
                // Initialize Data SDK
                const initResult = await window.dataSdk.init(dataHandler);
                if (!initResult.isOk) {
                    console.error("Failed to initialize data SDK");
                    return;
                }

                // Initialize Element SDK
                if (window.elementSdk) {
                    window.elementSdk.init({
                        defaultConfig,
                        onConfigChange: async (config) => {
                            document.getElementById('app-title').textContent = config.app_title || defaultConfig.app_title;
                            document.getElementById('instruction-text').textContent = config.instruction_text || defaultConfig.instruction_text;
                        },
                        mapToCapabilities: (config) => ({
                            recolorables: [
                                {
                                    get: () => config.primary_color || "#4f46e5",
                                    set: (value) => {
                                        config.primary_color = value;
                                        window.elementSdk.setConfig({ primary_color: value });
                                    }
                                },
                                {
                                    get: () => config.background_color || "#f8fafc",
                                    set: (value) => {
                                        config.background_color = value;
                                        window.elementSdk.setConfig({ background_color: value });
                                    }
                                }
                            ],
                            borderables: [],
                            fontEditable: {
                                get: () => config.font_family || "Inter",
                                set: (value) => {
                                    config.font_family = value;
                                    window.elementSdk.setConfig({ font_family: value });
                                }
                            },
                            fontSizeable: {
                                get: () => config.font_size || 16,
                                set: (value) => {
                                    config.font_size = value;
                                    window.elementSdk.setConfig({ font_size: value });
                                }
                            }
                        }),
                        mapToEditPanelValues: (config) => new Map([
                            ["app_title", config.app_title || defaultConfig.app_title],
                            ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
                            ["success_message", config.success_message || defaultConfig.success_message]
                        ])
                    });
                }

                // Generate first question and setup
                generateNewQuestion();
                setupEventListeners();
            } catch (error) {
                console.error("Error initializing app:", error);
            }
        }

        function generateNewQuestion() {
            try {
                const randomHex = hexNumbers[Math.floor(Math.random() * hexNumbers.length)];
                currentQuestion = {
                    hex: randomHex,
                    decimal: parseInt(randomHex, 16)
                };

                displayHexNumber(randomHex);
                resetUI();
            } catch (error) {
                console.error("Error generating question:", error);
            }
        }

        function displayHexNumber(hex) {
            try {
                const hexDisplay = document.getElementById('hex-display');
                if (!hexDisplay) {
                    console.error('Hex display element not found');
                    return;
                }
                
                hexDisplay.innerHTML = '';
                
                // Create each digit with proper styling
                for (let i = 0; i < hex.length; i++) {
                    const digit = document.createElement('span');
                    digit.textContent = hex[i];
                    digit.className = 'hex-digit';
                    hexDisplay.appendChild(digit);
                }
            } catch (error) {
                console.error("Error displaying hex number:", error);
                // Fallback - show the hex number directly
                const hexDisplay = document.getElementById('hex-display');
                if (hexDisplay) {
                    hexDisplay.textContent = hex;
                }
            }
        }

        function resetUI() {
            document.getElementById('answer-input').value = '';
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('calculation-steps').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('check-btn').classList.remove('hidden');
            document.getElementById('answer-input').disabled = false;
        }

        function showCalculationSteps(hex) {
            const stepsContent = document.getElementById('steps-content');
            stepsContent.innerHTML = '';

            let calculation = '';
            let total = 0;

            for (let i = 0; i < hex.length; i++) {
                const digit = hex[i];
                const position = hex.length - 1 - i;
                const digitValue = parseInt(digit, 16);
                const positionValue = Math.pow(16, position);
                const stepValue = digitValue * positionValue;

                const stepDiv = document.createElement('div');
                stepDiv.className = 'calculation-step mb-2 p-2 sm:p-3 bg-white rounded border-l-4 border-indigo-400';
                stepDiv.innerHTML = `
                    <div class="text-sm sm:text-base">
                        <span class="font-mono text-base sm:text-lg">${digit}</span> √ó 16<sup class="text-xs sm:text-sm">${position}</sup> = 
                        <span class="font-mono">${digitValue}</span> √ó <span class="font-mono">${positionValue}</span> = 
                        <span class="font-bold text-indigo-600">${stepValue}</span>
                    </div>
                `;
                stepsContent.appendChild(stepDiv);

                total += stepValue;
                if (i < hex.length - 1) {
                    calculation += `${stepValue} + `;
                } else {
                    calculation += `${stepValue} = ${total}`;
                }
            }

            const totalDiv = document.createElement('div');
            totalDiv.className = 'calculation-step mt-3 sm:mt-4 p-3 bg-indigo-50 rounded border-2 border-indigo-200';
            totalDiv.innerHTML = `
                <div class="font-semibold text-indigo-800 text-sm sm:text-base">Jumlah:</div>
                <div class="font-mono text-sm sm:text-base lg:text-lg break-all">${calculation}</div>
            `;
            stepsContent.appendChild(totalDiv);

            document.getElementById('calculation-steps').classList.remove('hidden');
        }

        async function checkAnswer() {
            try {
                const checkBtn = document.getElementById('check-btn');
                const userAnswer = parseInt(document.getElementById('answer-input').value);
                const feedback = document.getElementById('feedback');
                const config = window.elementSdk ? window.elementSdk.config : defaultConfig;

                // Show loading state
                checkBtn.disabled = true;
                checkBtn.textContent = 'Menyemak...';
                checkBtn.classList.add('opacity-75');

                if (isNaN(userAnswer)) {
                    feedback.textContent = 'Sila masukkan nombor yang sah.';
                    feedback.className = 'text-base sm:text-lg font-semibold text-red-600';
                    feedback.classList.remove('hidden');
                    
                    // Reset button
                    checkBtn.disabled = false;
                    checkBtn.textContent = 'Semak Jawapan';
                    checkBtn.classList.remove('opacity-75');
                    return;
                }

                const isCorrect = userAnswer === currentQuestion.decimal;
                
                // Check data limit before creating new record
                if (currentRecordCount >= 999) {
                    feedback.textContent = 'Had maksimum 999 soalan telah dicapai. Sila mula semula latihan.';
                    feedback.className = 'text-base sm:text-lg font-semibold text-orange-600';
                    feedback.classList.remove('hidden');
                    return;
                }

                // Save attempt to data
                const result = await window.dataSdk.create({
                    question_id: `q_${Date.now()}`,
                    hex_number: currentQuestion.hex,
                    user_answer: userAnswer.toString(),
                    correct_answer: currentQuestion.decimal.toString(),
                    is_correct: isCorrect,
                    timestamp: new Date().toISOString()
                });

                if (!result.isOk) {
                    feedback.textContent = 'Ralat menyimpan data. Sila cuba lagi.';
                    feedback.className = 'text-base sm:text-lg font-semibold text-red-600';
                    feedback.classList.remove('hidden');
                    return;
                }

                if (isCorrect) {
                    correctCount++;
                    feedback.textContent = config.success_message || defaultConfig.success_message;
                    feedback.className = 'text-base sm:text-lg font-semibold text-green-600 success-animation';
                } else {
                    feedback.textContent = `Tidak betul. Jawapan yang betul ialah ${currentQuestion.decimal}.`;
                    feedback.className = 'text-base sm:text-lg font-semibold text-red-600';
                }

                questionCount++;
                feedback.classList.remove('hidden');
                document.getElementById('check-btn').classList.add('hidden');
                document.getElementById('next-btn').classList.remove('hidden');
                document.getElementById('answer-input').disabled = true;

                updateProgress();
            } catch (error) {
                console.error("Error checking answer:", error);
                const feedback = document.getElementById('feedback');
                feedback.textContent = 'Ralat semasa menyemak jawapan. Sila cuba lagi.';
                feedback.className = 'text-base sm:text-lg font-semibold text-red-600';
                feedback.classList.remove('hidden');
            }
        }

        function updateProgress() {
            document.getElementById('total-questions').textContent = questionCount;
            document.getElementById('correct-answers').textContent = correctCount;
            const accuracy = questionCount > 0 ? Math.round((correctCount / questionCount) * 100) : 0;
            document.getElementById('accuracy').textContent = `${accuracy}%`;
            document.getElementById('question-counter').textContent = questionCount + 1;
        }

        function setupEventListeners() {
            // Add visual feedback for button clicks
            document.getElementById('check-btn').addEventListener('click', (e) => {
                e.preventDefault();
                e.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.target.style.transform = 'scale(1)';
                }, 100);
                checkAnswer();
            });
            
            document.getElementById('show-steps-btn').addEventListener('click', (e) => {
                e.preventDefault();
                e.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.target.style.transform = 'scale(1)';
                }, 100);
                
                if (currentQuestion) {
                    showCalculationSteps(currentQuestion.hex);
                }
            });
            
            document.getElementById('next-btn').addEventListener('click', (e) => {
                e.preventDefault();
                e.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.target.style.transform = 'scale(1)';
                }, 100);
                generateNewQuestion();
            });
            
            document.getElementById('answer-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const checkBtn = document.getElementById('check-btn');
                    const nextBtn = document.getElementById('next-btn');
                    
                    if (!checkBtn.classList.contains('hidden')) {
                        checkAnswer();
                    } else if (!nextBtn.classList.contains('hidden')) {
                        generateNewQuestion();
                    }
                }
            });
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9950d79441d9cf0c',t:'MTc2MTU1MzkzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
