<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Latihan Sistem Nombor Perenambelasan</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-correct {
            animation: pulseGreen 0.6s ease-in-out;
        }
        .pulse-wrong {
            animation: pulseRed 0.6s ease-in-out;
        }
        @keyframes pulseGreen {
            0%, 100% { background-color: #10b981; }
            50% { background-color: #059669; }
        }
        @keyframes pulseRed {
            0%, 100% { background-color: #ef4444; }
            50% { background-color: #dc2626; }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="min-h-full">
  <main class="min-h-full p-6">
   <div class="max-w-4xl mx-auto"><!-- Header -->
    <header class="text-center mb-8">
     <div class="mb-6 p-6 rounded-xl border-2 bg-gradient-to-r from-cyan-500 to-emerald-500 text-white">
      <div class="text-6xl mb-4">
       üî¢
      </div>
      <h1 id="main-title" class="text-3xl font-bold mb-4">PRAKTIS: Penukaran Nombor Perenambelasan ke Perpuluhan</h1>
      <p id="instructions" class="text-lg opacity-90">Bab 1.2 - Sistem Nombor Perenambelasan | Asas Sains Komputer Tingkatan 2</p>
     </div><!-- Introduction Section -->
     <div class="mb-8 p-6 rounded-lg border-2 text-left">
      <h2 class="text-2xl font-bold mb-4 text-center">üìö Pengenalan</h2>
      <div class="space-y-4">
       <div class="p-4 rounded-lg border border-cyan-300">
        <h3 class="font-semibold text-lg mb-2">üéØ Objektif Pembelajaran:</h3>
        <p>Murid dapat menukar nombor perenambelasan (base 16) kepada nombor perpuluhan (base 10) dengan menggunakan kaedah pengembangan kedudukan.</p>
       </div>
       <div class="p-4 rounded-lg border border-emerald-300">
        <h3 class="font-semibold text-lg mb-2">üí° Ingat Kembali:</h3>
        <div class="grid md:grid-cols-2 gap-4 text-sm">
         <div><strong>Digit Perenambelasan:</strong><br>
           0, 1, 2, 3, 4, 5, 6, 7, 8, 9, A, B, C, D, E, F
         </div>
         <div><strong>Nilai Huruf:</strong><br>
           A=10, B=11, C=12, D=13, E=14, F=15
         </div>
        </div>
       </div>
       <div class="p-4 rounded-lg border border-purple-300">
        <h3 class="font-semibold text-lg mb-2">üìù Contoh:</h3>
        <div class="bg-gray-100 p-4 rounded text-gray-800">
         <div class="font-bold mb-2">
          Tukar 2A‚ÇÅ‚ÇÜ kepada perpuluhan:
         </div>
         <div class="text-sm space-y-1">
          <div>
           üîç Langkah 1: 2A‚ÇÅ‚ÇÜ
          </div>
          <div>
           üî¢ Langkah 2: 2(kedudukan 1), A(kedudukan 0)
          </div>
          <div>
           üí° Langkah 3: 2 = 2, A = 10
          </div>
          <div>
           ‚ö° Langkah 4: 2 √ó 16¬π + 10 √ó 16‚Å∞ = 2 √ó 16 + 10 √ó 1 = 32 + 10
          </div>
          <div class="font-bold text-purple-600">
           ‚úÖ Langkah 5: 42‚ÇÅ‚ÇÄ
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </header><!-- Progress Section -->
    <div class="mb-8 p-6 rounded-xl border-2 border-emerald-400 bg-gradient-to-r from-slate-800 to-slate-700 shadow-lg">
     <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-semibold text-emerald-300">üìä Kemajuan Anda</h2>
      <div class="text-sm bg-emerald-500 text-white px-3 py-1 rounded-full font-bold"><span id="correct-count">0</span> betul dari <span id="total-count">0</span> soalan
      </div>
     </div>
     <div class="w-full h-6 bg-slate-600 rounded-full overflow-hidden shadow-inner">
      <div id="progress-bar" class="h-full bg-gradient-to-r from-emerald-400 to-teal-400 transition-all duration-500 shadow-lg" style="width: 0%"></div>
     </div>
    </div><!-- Question Section -->
    <div class="mb-8 p-8 rounded-lg border-2 bg-gradient-to-br from-slate-800 to-slate-700 text-white">
     <div class="text-center mb-6">
      <div class="inline-block px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full text-white font-bold mb-4">
       Soalan <span id="question-number">1</span>
      </div>
      <div class="text-4xl font-bold mb-2 text-white">
       Tukarkan <span id="hex-number" class="px-6 py-3 bg-gradient-to-r from-cyan-400 to-blue-500 text-white rounded-lg shadow-lg transform hover:scale-105 transition-transform">A3</span><sub class="text-cyan-400">16</sub> kepada perpuluhan
      </div>
     </div><!-- Answer Input -->
     <div class="text-center mb-6"><label for="answer-input" class="block text-lg font-medium mb-3 text-cyan-300">üí≠ Jawapan anda:</label> <input type="number" id="answer-input" class="w-40 p-4 text-2xl text-center border-2 border-cyan-400 rounded-xl focus:outline-none focus:ring-4 focus:ring-cyan-300 bg-slate-600 text-white placeholder-slate-400 shadow-lg" placeholder="?">
     </div><!-- Action Buttons -->
     <div class="text-center space-x-4"><button id="check-btn" class="px-8 py-4 text-white font-bold rounded-xl bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 transition-all duration-200 hover:scale-105 shadow-lg transform"> <span id="check-button-text">‚úÖ Semak Jawapan</span> </button> <button id="next-btn" class="px-8 py-4 font-bold rounded-xl border-2 border-purple-400 bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 transition-all duration-200 hover:scale-105 shadow-lg transform hidden"> <span id="next-button-text">‚û°Ô∏è Soalan Seterusnya</span> </button>
     </div><!-- Feedback -->
     <div id="feedback" class="mt-6 p-4 rounded-lg text-center hidden">
      <div id="feedback-content"></div>
     </div>
    </div><!-- Results History -->
    <div class="p-6 rounded-xl border-2 border-purple-400 bg-gradient-to-r from-slate-800 to-slate-700 shadow-lg">
     <h3 class="text-xl font-semibold mb-4 text-purple-300">üìã Rekod Jawapan</h3>
     <div id="results-list" class="space-y-3">
      <p class="text-center text-slate-400 italic">Belum ada jawapan lagi. Mula jawab soalan! üöÄ</p>
     </div>
    </div>
   </div>
  </main>
  <script>
        // Configuration
        const defaultConfig = {
            main_title: "PRAKTIS: Penukaran Nombor Perenambelasan ke Perpuluhan",
            instructions: "Bab 1.2 - Sistem Nombor Perenambelasan | Asas Sains Komputer Tingkatan 2",
            check_button_text: "Semak Jawapan",
            next_button_text: "Soalan Seterusnya",
            background_color: "#0f172a",
            surface_color: "#1e293b",
            text_color: "#f1f5f9",
            primary_color: "#06b6d4",
            accent_color: "#10b981",
            font_family: "Inter",
            font_size: 16
        };

        // Application state
        let currentQuestion = null;
        let questionCount = 0;
        let correctCount = 0;
        let allResults = [];
        let isAnswered = false;

        // Hex numbers for practice (easy to medium difficulty)
        const hexNumbers = ['A', 'B', 'C', 'D', 'E', 'F', '1A', '2B', '3C', '4D', '5E', '6F', 'A1', 'B2', 'C3', 'D4', 'E5', 'F6', '1AB', '2CD', '3EF', 'ABC', 'DEF'];

        // Data SDK handler
        const dataHandler = {
            onDataChanged(data) {
                allResults = data;
                updateResultsDisplay();
                updateProgress();
            }
        };

        // Element SDK implementation
        async function onConfigChange(config) {
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const baseFontStack = 'system-ui, -apple-system, sans-serif';

            // Apply colors
            document.body.style.backgroundColor = config.background_color || defaultConfig.background_color;
            document.body.style.color = config.text_color || defaultConfig.text_color;

            // Apply fonts
            document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
            document.getElementById('main-title').style.fontSize = `${baseSize * 1.875}px`;
            document.getElementById('instructions').style.fontSize = `${baseSize * 1.125}px`;

            // Update surface colors
            const surfaces = document.querySelectorAll('.border-2');
            surfaces.forEach(surface => {
                surface.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
                surface.style.borderColor = config.primary_color || defaultConfig.primary_color;
            });

            // Update button colors
            const checkBtn = document.getElementById('check-btn');
            const nextBtn = document.getElementById('next-btn');
            checkBtn.style.backgroundColor = config.primary_color || defaultConfig.primary_color;
            nextBtn.style.backgroundColor = config.surface_color || defaultConfig.surface_color;
            nextBtn.style.borderColor = config.primary_color || defaultConfig.primary_color;
            nextBtn.style.color = config.primary_color || defaultConfig.primary_color;

            // Update progress bar
            document.getElementById('progress-bar').style.backgroundColor = config.accent_color || defaultConfig.accent_color;

            // Update text content
            document.getElementById('main-title').textContent = config.main_title || defaultConfig.main_title;
            document.getElementById('instructions').textContent = config.instructions || defaultConfig.instructions;
            document.getElementById('check-button-text').textContent = config.check_button_text || defaultConfig.check_button_text;
            document.getElementById('next-button-text').textContent = config.next_button_text || defaultConfig.next_button_text;

            // Update input focus colors
            const input = document.getElementById('answer-input');
            input.style.borderColor = config.primary_color || defaultConfig.primary_color;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.background_color || defaultConfig.background_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.surface_color || defaultConfig.surface_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ surface_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.text_color || defaultConfig.text_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ text_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    },
                    {
                        get: () => config.accent_color || defaultConfig.accent_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ accent_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: {
                    get: () => config.font_family || defaultConfig.font_family,
                    set: (value) => {
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    }
                },
                fontSizeable: {
                    get: () => config.font_size || defaultConfig.font_size,
                    set: (value) => {
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["main_title", config.main_title || defaultConfig.main_title],
                ["instructions", config.instructions || defaultConfig.instructions],
                ["check_button_text", config.check_button_text || defaultConfig.check_button_text],
                ["next_button_text", config.next_button_text || defaultConfig.next_button_text]
            ]);
        }

        // Hex to decimal conversion
        function hexToDecimal(hex) {
            return parseInt(hex, 16);
        }

        // Generate step-by-step breakdown (Tingkatan 2 method)
        function generateStepBreakdown(hex) {
            const steps = [];
            const digits = hex.split('').reverse();
            
            steps.push(`üîç Langkah 1: Kenalpasti nombor perenambelasan ‚Üí ${hex}‚ÇÅ‚ÇÜ`);
            
            // Show position values
            let positionInfo = 'üî¢ Langkah 2: Tentukan kedudukan (dari kanan ke kiri):';
            for (let i = digits.length - 1; i >= 0; i--) {
                const digit = digits[i];
                positionInfo += ` ${digit}(kedudukan ${i})`;
            }
            steps.push(positionInfo);
            
            // Show digit values
            steps.push('üí° Langkah 3: Tukar huruf kepada nombor (jika ada):');
            let digitValues = '';
            for (let i = digits.length - 1; i >= 0; i--) {
                const digit = digits[i];
                const digitValue = isNaN(digit) ? (digit.charCodeAt(0) - 55) : parseInt(digit);
                if (digitValues) digitValues += ', ';
                digitValues += `${digit} = ${digitValue}`;
            }
            steps.push(`   ${digitValues}`);
            
            // Show calculation using expansion method
            steps.push('‚ö° Langkah 4: Guna kaedah pengembangan kedudukan:');
            let calculation = '';
            let total = 0;
            
            for (let i = 0; i < digits.length; i++) {
                const digit = digits[i];
                const digitValue = isNaN(digit) ? (digit.charCodeAt(0) - 55) : parseInt(digit);
                const positionValue = Math.pow(16, i);
                const result = digitValue * positionValue;
                
                if (i > 0) calculation += ' + ';
                calculation += `${digitValue} √ó 16^${i}`;
                if (positionValue !== 1) calculation += ` = ${digitValue} √ó ${positionValue}`;
                calculation += ` = ${result}`;
                
                total += result;
            }
            
            steps.push(`   ${calculation}`);
            steps.push(`‚úÖ Langkah 5: Jumlahkan semua ‚Üí ${total}‚ÇÅ‚ÇÄ`);
            
            return steps;
        }

        // Generate new question
        function generateQuestion() {
            const hex = hexNumbers[Math.floor(Math.random() * hexNumbers.length)];
            const decimal = hexToDecimal(hex);
            
            currentQuestion = {
                hex: hex,
                decimal: decimal,
                steps: generateStepBreakdown(hex)
            };
            
            questionCount++;
            isAnswered = false;
            
            // Update UI
            document.getElementById('question-number').textContent = questionCount;
            document.getElementById('hex-number').textContent = hex;
            document.getElementById('answer-input').value = '';
            document.getElementById('answer-input').disabled = false;
            document.getElementById('check-btn').classList.remove('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('feedback').classList.add('hidden');
            

        }

        // Check answer
        async function checkAnswer() {
            if (isAnswered) return;
            
            const userAnswer = parseInt(document.getElementById('answer-input').value);
            const isCorrect = userAnswer === currentQuestion.decimal;
            
            isAnswered = true;
            
            // Show loading state
            const checkBtn = document.getElementById('check-btn');
            const originalText = checkBtn.textContent;
            checkBtn.textContent = 'Menyemak...';
            checkBtn.disabled = true;
            
            // Save result to Data SDK
            const result = await window.dataSdk.create({
                question: `${currentQuestion.hex}‚ÇÅ‚ÇÜ ‚Üí ${currentQuestion.decimal}‚ÇÅ‚ÇÄ`,
                user_answer: userAnswer.toString(),
                correct_answer: currentQuestion.decimal.toString(),
                is_correct: isCorrect,
                timestamp: new Date().toISOString()
            });
            
            if (!result.isOk) {
                console.error('Failed to save result');
            }
            
            // Update UI
            checkBtn.textContent = originalText;
            checkBtn.disabled = false;
            
            if (isCorrect) {
                correctCount++;
                showFeedback(true, `üéâ Betul! ${currentQuestion.hex}‚ÇÅ‚ÇÜ = ${currentQuestion.decimal}‚ÇÅ‚ÇÄ`);
                checkBtn.classList.add('pulse-correct');
            } else {
                showFeedback(false, `‚ùå Tidak betul. Jawapan yang betul ialah ${currentQuestion.decimal}‚ÇÅ‚ÇÄ`);
                checkBtn.classList.add('pulse-wrong');
            }
            
            // Remove animation class after animation completes
            setTimeout(() => {
                checkBtn.classList.remove('pulse-correct', 'pulse-wrong');
            }, 600);
            
            document.getElementById('answer-input').disabled = true;
            document.getElementById('check-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.remove('hidden');
            
            updateProgress();
        }

        // Show feedback
        function showFeedback(isCorrect, message) {
            const feedback = document.getElementById('feedback');
            const content = document.getElementById('feedback-content');
            
            content.innerHTML = `
                <div class="text-lg font-semibold">${message}</div>
                <div class="mt-2 text-sm">
                    Pengiraan: ${currentQuestion.steps.slice(-2).join(' ‚Üí ')}
                </div>
            `;
            
            if (isCorrect) {
                feedback.className = 'mt-6 p-4 rounded-lg text-center fade-in';
                feedback.style.backgroundColor = window.elementSdk?.config?.accent_color || defaultConfig.accent_color;
                feedback.style.color = 'white';
            } else {
                feedback.className = 'mt-6 p-4 rounded-lg text-center fade-in';
                feedback.style.backgroundColor = '#ef4444';
                feedback.style.color = 'white';
            }
            
            feedback.classList.remove('hidden');
        }

        // Update progress
        function updateProgress() {
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('total-count').textContent = questionCount;
            
            const percentage = questionCount > 0 ? (correctCount / questionCount) * 100 : 0;
            document.getElementById('progress-bar').style.width = `${percentage}%`;
        }

        // Update results display
        function updateResultsDisplay() {
            const container = document.getElementById('results-list');
            
            if (allResults.length === 0) {
                container.innerHTML = '<p class="text-center">Belum ada jawapan lagi. Mula jawab soalan!</p>';
                return;
            }
            
            // Show last 5 results
            const recentResults = allResults.slice(-5).reverse();
            container.innerHTML = recentResults.map(result => `
                <div class="flex justify-between items-center p-4 rounded-lg border-2 ${result.is_correct ? 'border-green-400 bg-green-900/30' : 'border-red-400 bg-red-900/30'} shadow-md">
                    <span class="font-medium">${result.question}</span>
                    <div class="flex items-center space-x-3">
                        <span class="text-sm px-2 py-1 rounded bg-slate-600 text-white">Jawapan: ${result.user_answer}</span>
                        <span class="${result.is_correct ? 'text-green-400 bg-green-500' : 'text-red-400 bg-red-500'} font-bold px-3 py-1 rounded-full text-white shadow-lg">
                            ${result.is_correct ? '‚úì BETUL' : '‚úó SALAH'}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        // Event listeners
        document.getElementById('check-btn').addEventListener('click', checkAnswer);
        document.getElementById('next-btn').addEventListener('click', generateQuestion);
        
        document.getElementById('answer-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !isAnswered) {
                checkAnswer();
            }
        });

        // Initialize application
        async function init() {
            // Initialize Element SDK
            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }
            
            // Initialize Data SDK
            if (window.dataSdk) {
                const initResult = await window.dataSdk.init(dataHandler);
                if (!initResult.isOk) {
                    console.error('Failed to initialize data SDK');
                }
            }
            
            // Apply initial config
            await onConfigChange(defaultConfig);
            
            // Generate first question
            generateQuestion();
        }

        // Start the application
        init();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99510e90a0b8e41e',t:'MTc2MTU1NjE5MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
